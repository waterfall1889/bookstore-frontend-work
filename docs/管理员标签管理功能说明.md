# 管理员标签管理功能说明

## 功能概述

管理员现在可以在前端界面为图书添加、删除和管理标签。标签会自动同步到Neo4J图数据库中，用于智能搜索功能。

## 功能位置

### 1. 编辑图书页面 (`/manager/booksEdit/:id`)

在编辑图书信息时，可以管理该图书的标签：

- **查看当前标签**：页面会显示图书已有的所有标签
- **添加标签**：从下拉列表中选择标签添加到图书
- **删除标签**：点击标签上的 × 按钮可以移除标签
- **保存标签**：点击"保存标签"按钮保存所有更改

### 2. 添加图书页面 (`/manager/addBook`)

在添加新图书时，可以预先选择标签：

- **选择标签**：从下拉列表中选择一个或多个标签
- **移除标签**：点击已选标签上的 × 按钮可以移除
- **自动关联**：图书添加成功后，会自动关联选择的标签

## 使用步骤

### 编辑图书标签

1. 进入管理员界面
2. 导航到"图书管理"
3. 点击图书卡片上的"信息编辑"按钮
4. 滚动到"标签管理"部分
5. 从下拉列表中选择标签添加，或点击标签上的 × 移除标签
6. 点击"保存标签"按钮保存更改

### 添加图书时选择标签

1. 进入管理员界面
2. 导航到"添加图书"
3. 填写图书信息
4. 在"图书标签"部分选择标签
5. 提交表单，标签会自动关联到新添加的图书

## API接口

### 获取图书标签
```http
GET /api/books/{bookId}/tags
```

### 为图书添加标签
```http
POST /api/books/{bookId}/tags
Content-Type: application/json

{
  "tagName": "Science Fiction"
}
```

### 为图书批量添加标签
```http
POST /api/books/{bookId}/tags/batch
Content-Type: application/json

{
  "tagNames": ["Science Fiction", "Technology"]
}
```

### 从图书移除标签
```http
DELETE /api/books/{bookId}/tags/{tagName}
```

### 更新图书标签（替换所有）
```http
PUT /api/books/{bookId}/tags
Content-Type: application/json

{
  "tagNames": ["Science Fiction", "Technology", "Programming"]
}
```

## 注意事项

1. **标签自动同步**：添加标签时会自动同步到Neo4J，如果Neo4J不可用，会在日志中记录警告，但不会影响MySQL中的标签存储

2. **标签必须存在**：只能选择系统中已存在的标签，如果需要新标签，需要先在数据库中创建

3. **标签搜索**：添加标签后，用户可以通过标签搜索功能找到相关图书

4. **标签关系**：标签之间的关系在Neo4J中维护，用于智能搜索（通过2次边连接查找相关标签）

## 故障排查

### 标签列表为空
- 检查是否已执行 `tags_schema.sql` 创建标签表
- 检查数据库中是否有标签数据
- 查看浏览器控制台是否有错误

### 无法添加标签
- 检查后端服务是否正常运行
- 查看浏览器网络请求是否成功
- 检查标签名称是否已存在

### 标签未同步到Neo4J
- 检查Neo4J服务是否运行
- 验证Neo4J连接配置
- 查看后端日志中的警告信息

